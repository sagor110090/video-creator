import{r as u,o as N,c as a,a as o,b as T,u as R,h as F,w as H,d as e,e as W,f as q,g as d,v as h,F as k,i as _,t as n,j as x,k as v,l as V,n as M,T as Y,m as y}from"./app-Behtw7vn.js";import{A as P}from"./AppLayout-CcczSg_T.js";const G={class:"max-w-7xl mx-auto space-y-6"},I={class:"bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 p-6"},J={class:"space-y-1"},K={class:"space-y-1"},O={class:"space-y-1"},Q=["value"],X={class:"space-y-1"},Z={class:"space-y-1"},ee={class:"flex items-end"},te=["disabled"],se={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},le={class:"bg-white dark:bg-slate-900 rounded-xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden"},oe={class:"px-6 py-4 border-b border-slate-200 dark:border-slate-800 flex items-center justify-between"},ae={class:"overflow-x-auto"},re={class:"w-full text-left"},ie={class:"divide-y divide-slate-200 dark:divide-slate-800"},ne={key:0,class:"text-center py-10"},de={class:"px-6 py-4"},ue={class:"text-sm font-medium text-slate-900 dark:text-white"},ce={class:"text-xs text-slate-500"},pe={class:"px-6 py-4"},be={key:0,class:"flex items-center"},xe=["src"],ve={class:"text-sm text-slate-600 dark:text-slate-300"},me={key:1,class:"text-xs text-slate-400"},ge={class:"px-6 py-4 text-sm font-bold text-indigo-600 dark:text-indigo-400"},fe={class:"px-6 py-4 text-sm text-slate-600 dark:text-slate-300"},ke={class:"px-6 py-4"},ye=["title"],he={class:"px-6 py-4 text-right"},_e={class:"flex items-center justify-end space-x-2"},we=["onClick"],Ce=["onClick"],Se=["onClick"],Ve={key:0,class:"px-6 py-4 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-800 flex justify-center"},Me={class:"flex space-x-1"},Te=["onClick","disabled","innerHTML"],He={key:0,class:"fixed inset-0 z-[9999] overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},je={class:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0"},Ae={class:"relative inline-block align-bottom bg-white dark:bg-slate-900 rounded-3xl text-left overflow-hidden shadow-[0_20px_70px_-10px_rgba(0,0,0,0.5)] transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full border border-slate-200/50 dark:border-slate-800/50 z-50"},$e={class:"bg-white dark:bg-slate-900 px-6 pt-6 pb-6"},Be={class:"sm:flex sm:items-start"},Ue={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},Ee={class:"flex items-center justify-between mb-8"},Le={class:"space-y-6"},De={class:"space-y-2"},ze={class:"space-y-2"},Ne={class:"space-y-2"},Re=["value"],Fe={class:"grid grid-cols-2 gap-5"},We={class:"space-y-2"},qe={class:"space-y-2"},Ye={class:"bg-slate-50/50 dark:bg-slate-800/30 px-8 py-6 flex flex-col sm:flex-row-reverse gap-4 border-t border-slate-100 dark:border-slate-800/50"},Pe=["disabled"],Ge={key:0,class:"animate-spin -ml-1 mr-2 h-5 w-5 text-white",fill:"none",viewBox:"0 0 24 24"},Oe={__name:"Schedules",setup(Ie){const c=u({data:[]}),m=u([]),w=u(!1),g=u(!1),f=u(!1),p=u(!1),C=u(null),r=u({topic:"",style:"story",aspect_ratio:"16:9",scheduled_time:"",youtube_token_id:null}),i=u({topic:"",style:"story",aspect_ratio:"16:9",scheduled_time:"",youtube_token_id:null}),b=async(l=1)=>{w.value=!0;try{const t=await y.get(`/api/schedules?page=${l}`);c.value=t.data}catch(t){console.error("Error fetching schedules:",t)}finally{w.value=!1}},j=async()=>{try{const l=await y.get("/api/youtube/channels");m.value=l.data,m.value.length>0&&!r.value.youtube_token_id&&(r.value.youtube_token_id=m.value[0].id)}catch(l){console.error("Error fetching channels:",l)}},A=async()=>{g.value=!0;try{await y.post("/api/schedules",r.value),r.value.topic="",r.value.scheduled_time="",b()}catch(l){console.error("Error creating schedule:",l),alert(l.response?.data?.message||"Failed to create schedule")}finally{g.value=!1}},$=l=>{C.value=l,i.value={topic:l.topic||"",style:l.style||"story",aspect_ratio:l.aspect_ratio||"16:9",scheduled_time:l.scheduled_time?l.scheduled_time.substring(0,5):"",youtube_token_id:l.youtube_token_id},p.value=!0},B=async()=>{if(C.value){f.value=!0;try{await y.patch(`/api/schedules/${C.value.id}`,i.value),p.value=!1,b()}catch(l){console.error("Error updating schedule:",l),alert(l.response?.data?.message||"Failed to update schedule")}finally{f.value=!1}}},U=l=>{r.value={topic:`${l.topic} (Copy)`,style:l.style,aspect_ratio:l.aspect_ratio,scheduled_time:l.scheduled_time.substring(0,5),youtube_token_id:l.youtube_token_id},window.scrollTo({top:0,behavior:"smooth"})},E=async l=>{if(confirm("Are you sure you want to delete this schedule?"))try{await y.delete(`/api/schedules/${l}`),b()}catch(t){console.error("Error deleting schedule:",t)}},L=l=>{switch(l){case"pending":return"bg-slate-100 text-slate-700 dark:bg-slate-800 dark:text-slate-300";case"processing":return"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400";case"completed":return"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400";case"failed":return"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400";default:return"bg-slate-100 text-slate-700"}},D=l=>l?new Date(l).toLocaleDateString():"Never",z=l=>l?l.substring(0,5):"--:--";return N(()=>{b(),j()}),(l,t)=>(o(),a(k,null,[T(R(F),{title:"Video Schedules"}),T(P,null,{header:H(()=>[...t[14]||(t[14]=[V("Video Schedules",-1)])]),default:H(()=>[e("div",G,[e("div",I,[t[23]||(t[23]=e("h3",{class:"text-lg font-bold text-slate-900 dark:text-white mb-4"},"Create New Schedule",-1)),e("form",{onSubmit:q(A,["prevent"]),class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},[e("div",J,[t[15]||(t[15]=e("label",{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"Topic",-1)),d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>r.value.topic=s),type:"text",placeholder:"e.g. History of Rome",required:"",class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all dark:text-white"},null,512),[[h,r.value.topic]])]),e("div",K,[t[16]||(t[16]=e("label",{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"Daily Time",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value.scheduled_time=s),type:"time",required:"",class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all dark:text-white"},null,512),[[h,r.value.scheduled_time]])]),e("div",O,[t[17]||(t[17]=e("label",{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"YouTube Channel",-1)),d(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>r.value.youtube_token_id=s),class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all dark:text-white"},[(o(!0),a(k,null,_(m.value,s=>(o(),a("option",{key:s.id,value:s.id},n(s.channel_title),9,Q))),128))],512),[[x,r.value.youtube_token_id]])]),e("div",X,[t[19]||(t[19]=e("label",{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"Video Style",-1)),d(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>r.value.style=s),class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all dark:text-white"},[...t[18]||(t[18]=[e("option",{value:"story"},"Story",-1),e("option",{value:"science_short"},"Science Short",-1),e("option",{value:"hollywood_hype"},"Hollywood Hype",-1),e("option",{value:"trade_wave"},"Trade Wave",-1)])],512),[[x,r.value.style]])]),e("div",Z,[t[21]||(t[21]=e("label",{class:"text-sm font-medium text-slate-700 dark:text-slate-300"},"Aspect Ratio",-1)),d(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>r.value.aspect_ratio=s),class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none transition-all dark:text-white"},[...t[20]||(t[20]=[e("option",{value:"16:9"},"Widescreen (16:9)",-1),e("option",{value:"9:16"},"Shorts/Reels (9:16)",-1)])],512),[[x,r.value.aspect_ratio]])]),e("div",ee,[e("button",{type:"submit",disabled:g.value,class:"w-full px-6 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-indigo-400 text-white font-bold rounded-lg transition-all flex items-center justify-center"},[g.value?(o(),a("svg",se,[...t[22]||(t[22]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):v("",!0),V(" "+n(g.value?"Creating...":"Add Schedule"),1)],8,te)])],32)]),e("div",le,[e("div",oe,[t[25]||(t[25]=e("h3",{class:"font-bold text-slate-900 dark:text-white"},"Active Schedules",-1)),e("button",{onClick:t[5]||(t[5]=s=>b()),class:"p-2 text-slate-500 hover:text-indigo-600 transition-colors"},[(o(),a("svg",{class:M(["w-5 h-5",{"animate-spin":w.value}]),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...t[24]||(t[24]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])],2))])]),e("div",ae,[e("table",re,[t[30]||(t[30]=e("thead",null,[e("tr",{class:"bg-slate-50 dark:bg-slate-800/50 text-slate-500 dark:text-slate-400 text-xs uppercase tracking-wider"},[e("th",{class:"px-6 py-3 font-medium"},"Topic"),e("th",{class:"px-6 py-3 font-medium"},"Channel"),e("th",{class:"px-6 py-3 font-medium"},"Daily Time"),e("th",{class:"px-6 py-3 font-medium"},"Last Run"),e("th",{class:"px-6 py-3 font-medium"},"Status"),e("th",{class:"px-6 py-3 font-medium text-right"},"Actions")])],-1)),e("tbody",ie,[c.value.data.length===0?(o(),a("tr",ne,[...t[26]||(t[26]=[e("td",{colspan:"5",class:"px-6 py-10 text-slate-500 dark:text-slate-400"}," No schedules found. Create one above! ",-1)])])):v("",!0),(o(!0),a(k,null,_(c.value.data,s=>(o(),a("tr",{key:s.id,class:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors"},[e("td",de,[e("div",ue,n(s.topic),1),e("div",ce,n(s.style)+" • "+n(s.aspect_ratio),1)]),e("td",pe,[s.youtube_token?(o(),a("div",be,[e("img",{src:s.youtube_token.channel_thumbnail,class:"w-6 h-6 rounded-full mr-2"},null,8,xe),e("span",ve,n(s.youtube_token.channel_title),1)])):(o(),a("span",me,"No channel"))]),e("td",ge,n(z(s.scheduled_time)),1),e("td",fe,n(D(s.last_run_at)),1),e("td",ke,[e("span",{class:M(["px-2.5 py-0.5 rounded-full text-xs font-medium",L(s.status)])},n(s.status),3),s.last_error?(o(),a("div",{key:0,class:"text-[10px] text-red-500 mt-1 max-w-[150px] truncate",title:s.last_error},n(s.last_error),9,ye)):v("",!0)]),e("td",he,[e("div",_e,[e("button",{onClick:S=>U(s),class:"p-2 text-slate-400 hover:text-indigo-600 transition-colors",title:"Copy Schedule"},[...t[27]||(t[27]=[e("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7v8a2 2 0 002 2h6M8 7V5a2 2 0 012-2h4.586a1 1 0 01.707.293l4.414 4.414a1 1 0 01.293.707V15a2 2 0 01-2 2h-2M8 7H6a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2v-2"})],-1)])],8,we),e("button",{onClick:S=>$(s),class:"p-2 text-slate-400 hover:text-blue-600 transition-colors",title:"Edit Schedule"},[...t[28]||(t[28]=[e("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Ce),e("button",{onClick:S=>E(s.id),class:"p-2 text-slate-400 hover:text-red-600 transition-colors",title:"Delete Schedule"},[...t[29]||(t[29]=[e("svg",{class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,Se)])])]))),128))])])]),c.value.links&&c.value.links.length>3?(o(),a("div",Ve,[e("nav",Me,[(o(!0),a(k,null,_(c.value.links,s=>(o(),a("button",{key:s.label,onClick:S=>b(s.url?new l.URL(s.url).searchParams.get("page"):1),disabled:!s.url,innerHTML:s.label,class:M(["px-3 py-1 rounded text-sm transition-colors",s.active?"bg-indigo-600 text-white":"text-slate-600 dark:text-slate-400 hover:bg-slate-200 dark:hover:bg-slate-700"])},null,10,Te))),128))])])):v("",!0)])]),(o(),W(Y,{to:"body"},[p.value?(o(),a("div",He,[e("div",je,[e("div",{class:"fixed inset-0 bg-slate-900/70 backdrop-blur-md transition-opacity","aria-hidden":"true",onClick:t[6]||(t[6]=s=>p.value=!1)}),t[41]||(t[41]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",Ae,[e("div",$e,[e("div",Be,[e("div",Ue,[e("div",Ee,[t[32]||(t[32]=e("h3",{class:"text-2xl font-black text-slate-900 dark:text-white tracking-tight",id:"modal-title"}," Edit Schedule ",-1)),e("button",{onClick:t[7]||(t[7]=s=>p.value=!1),class:"p-2 -mr-2 text-slate-400 hover:text-slate-600 dark:text-slate-500 dark:hover:text-slate-300 transition-all rounded-full hover:bg-slate-100 dark:hover:bg-slate-800"},[...t[31]||(t[31]=[e("svg",{class:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2.5",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),e("div",Le,[e("div",De,[t[33]||(t[33]=e("label",{class:"text-sm font-bold text-slate-700 dark:text-slate-300 ml-1"},"Topic",-1)),d(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>i.value.topic=s),type:"text",class:"w-full px-5 py-3.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all dark:text-white font-medium",placeholder:"What's this schedule about?"},null,512),[[h,i.value.topic]])]),e("div",ze,[t[34]||(t[34]=e("label",{class:"text-sm font-bold text-slate-700 dark:text-slate-300 ml-1"},"Daily Time",-1)),d(e("input",{"onUpdate:modelValue":t[9]||(t[9]=s=>i.value.scheduled_time=s),type:"time",class:"w-full px-5 py-3.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all dark:text-white font-medium"},null,512),[[h,i.value.scheduled_time]])]),e("div",Ne,[t[35]||(t[35]=e("label",{class:"text-sm font-bold text-slate-700 dark:text-slate-300 ml-1"},"YouTube Channel",-1)),d(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>i.value.youtube_token_id=s),class:"w-full px-5 py-3.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all dark:text-white font-medium appearance-none"},[(o(!0),a(k,null,_(m.value,s=>(o(),a("option",{key:s.id,value:s.id},n(s.channel_title),9,Re))),128))],512),[[x,i.value.youtube_token_id]])]),e("div",Fe,[e("div",We,[t[37]||(t[37]=e("label",{class:"text-sm font-bold text-slate-700 dark:text-slate-300 ml-1"},"Video Style",-1)),d(e("select",{"onUpdate:modelValue":t[11]||(t[11]=s=>i.value.style=s),class:"w-full px-5 py-3.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all dark:text-white font-medium"},[...t[36]||(t[36]=[e("option",{value:"story"},"Story",-1),e("option",{value:"science_short"},"Science Short",-1),e("option",{value:"hollywood_hype"},"Hollywood Hype",-1),e("option",{value:"trade_wave"},"Trade Wave",-1)])],512),[[x,i.value.style]])]),e("div",qe,[t[39]||(t[39]=e("label",{class:"text-sm font-bold text-slate-700 dark:text-slate-300 ml-1"},"Aspect Ratio",-1)),d(e("select",{"onUpdate:modelValue":t[12]||(t[12]=s=>i.value.aspect_ratio=s),class:"w-full px-5 py-3.5 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl focus:ring-4 focus:ring-indigo-500/10 focus:border-indigo-500 outline-none transition-all dark:text-white font-medium"},[...t[38]||(t[38]=[e("option",{value:"16:9"},"Widescreen (16:9)",-1),e("option",{value:"9:16"},"Shorts/Reels (9:16)",-1)])],512),[[x,i.value.aspect_ratio]])])])])])])]),e("div",Ye,[e("button",{type:"button",onClick:B,disabled:f.value,class:"w-full sm:w-auto inline-flex justify-center items-center rounded-2xl px-8 py-3.5 bg-indigo-600 hover:bg-indigo-700 text-white font-black transition-all disabled:opacity-50 shadow-xl shadow-indigo-500/20 active:scale-95"},[f.value?(o(),a("svg",Ge,[...t[40]||(t[40]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):v("",!0),V(" "+n(f.value?"Saving Changes...":"Save Changes"),1)],8,Pe),e("button",{type:"button",onClick:t[13]||(t[13]=s=>p.value=!1),class:"w-full sm:w-auto inline-flex justify-center items-center rounded-2xl px-8 py-3.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-300 font-bold hover:bg-slate-100 dark:hover:bg-slate-700 transition-all active:scale-95"}," Cancel ")])])])])):v("",!0)]))]),_:1})],64))}};export{Oe as default};
