import{d as I,r as u,o as Y,c as G,a as r,w as S,b as K,e,f as i,g as A,u as O,h as q,F as b,i as p,n as m,t as d,j as Q,k as g,v as f,l as W,m as V,p as v}from"./app-3AXVBd-T.js";import{A as J}from"./AppLayout-3PL2ytlH.js";import{S as R}from"./sweetalert2.esm.all-BQxta0Da.js";const X={key:0,class:"text-center py-20 bg-white dark:bg-slate-900 rounded-2xl border border-slate-200 dark:border-slate-800"},Z={key:1,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ee={class:"p-6"},te={class:"flex items-start justify-between mb-4"},se={class:"flex-1"},oe={class:"text-lg font-bold text-slate-900 dark:text-white"},le={class:"text-sm text-slate-500 dark:text-slate-400 capitalize"},ae={class:"flex items-center space-x-2"},re=["onClick"],de=["onClick"],ie=["onClick"],ne=["onClick"],ue={class:"space-y-3"},ce={class:"flex items-center justify-between text-sm"},be={class:"font-bold text-slate-900 dark:text-white"},pe={class:"flex items-center justify-between text-sm"},xe={class:"font-bold text-slate-900 dark:text-white"},me={class:"flex items-center justify-between text-sm"},ve={class:"font-bold text-slate-900 dark:text-white"},ge={class:"text-sm"},ke={class:"flex flex-wrap gap-2 mt-2"},fe={key:0,class:"flex items-center gap-2 text-sm"},he=["src"],_e={class:"text-slate-700 dark:text-slate-300"},ye={class:"px-6 py-3 bg-slate-50 dark:bg-slate-800/50 border-t border-slate-200 dark:border-slate-800"},we={class:"flex items-center justify-between"},Ce={class:"text-xs text-slate-500"},Me={class:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"},Se={class:"p-6 border-b border-slate-200 dark:border-slate-800"},Ae={class:"text-xl font-bold text-slate-900 dark:text-white"},Te={class:"p-6 space-y-6"},Ve={class:"grid grid-cols-2 md:grid-cols-4 gap-3"},Ee=["onClick"],$e={class:"text-xs font-bold uppercase text-slate-700 dark:text-slate-300"},je={class:"grid grid-cols-2 gap-4"},ze={class:"flex p-1 bg-slate-100 dark:bg-slate-800 rounded-xl"},Ue=["onClick"],Be=["value"],He={class:"flex flex-wrap gap-2 mb-3"},Ne={class:"font-mono font-bold"},Le=["onClick"],Pe={class:"space-y-3"},De={class:"p-4 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700"},Fe={class:"grid grid-cols-2 sm:grid-cols-4 gap-2"},Ie=["onClick","disabled"],Ye={class:"p-4 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-200 dark:border-slate-700"},Ge={class:"flex gap-2"},Ke=["disabled"],Oe={class:"space-y-3"},qe={key:0},Qe={class:"grid grid-cols-2 gap-2"},We=["onClick"],Je=["src"],Re={class:"text-xs font-bold truncate dark:text-slate-200"},Xe={class:"p-6 border-t border-slate-200 dark:border-slate-800 flex justify-end space-x-3"},Ze=["disabled"],at={__name:"Schedules",setup(et){const a=I.useToast(),h=u([]),_=u([]),y=u(!1),w=u(!1),x=u(null),E=u(!1),c=u(""),T=u(document.documentElement.classList.contains("dark")),l=u({name:"",style:"science_short",aspect_ratio:"9:16",videos_per_day:5,timezone:"UTC",upload_times:["02:00"],youtube_token_id:null,prompt_template:"",is_active:!0}),$=["UTC","Asia/Dhaka","America/New_York","America/Los_Angeles","America/Chicago","Europe/London","Europe/Paris","Europe/Berlin","Asia/Tokyo","Asia/Dubai","Asia/Kolkata","Asia/Singapore","Asia/Hong_Kong","Australia/Sydney"],j=[{id:"story",name:"General Story",icon:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"},{id:"science_short",name:"60s Lab",icon:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.691.34a2 2 0 01-1.782 0l-.691-.34a6 6 0 00-3.86-.517l-2.387.477a2 2 0 00-1.022.547V18a2 2 0 002 2h12a2 2 0 002-2v-2.572zM12 11V3.5"},{id:"hollywood_hype",name:"Hollywood",icon:"M7 4V20M17 4V20M3 8H7M17 8H21M3 12H21M3 16H7M17 16H21M4 20H20"},{id:"trade_wave",name:"TradeWave",icon:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"}],k=async()=>{try{const o=await v.get("/api/schedules");h.value=o.data}catch(o){console.error("Error fetching schedules:",o)}},z=async()=>{try{const o=await v.get("/api/youtube/channels");_.value=o.data}catch(o){console.error("Error fetching channels:",o)}},C=(o=null)=>{o&&o.id?(x.value=o,l.value={...o,upload_times:o.upload_times||[]}):(x.value=null,l.value={name:"",style:"science_short",aspect_ratio:"9:16",videos_per_day:5,timezone:"UTC",upload_times:["02:00"],youtube_token_id:null,prompt_template:"",is_active:!0}),w.value=!0},M=()=>{w.value=!1,x.value=null},U=()=>{c.value&&/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(c.value)?(l.value.upload_times.push(c.value),l.value.upload_times.sort(),c.value="",E.value=!1,a.success("Upload time added")):a.error("Invalid time format. Use HH:MM (e.g., 02:00)")},B=o=>{const t=`${o.toString().padStart(2,"0")}:00`;l.value.upload_times.includes(t)?a.info(`${t} already added`):(l.value.upload_times.push(t),l.value.upload_times.sort(),a.success(`Added ${t}`))},H=[{label:"Early Morning (6 AM)",time:"06:00"},{label:"Morning (9 AM)",time:"09:00"},{label:"Noon (12 PM)",time:"12:00"},{label:"Afternoon (3 PM)",time:"15:00"},{label:"Evening (6 PM)",time:"18:00"},{label:"Night (9 PM)",time:"21:00"},{label:"Late Night (12 AM)",time:"00:00"},{label:"2 AM",time:"02:00"}],N=o=>{l.value.upload_times.splice(o,1)},L=async()=>{if(!l.value.name){a.error("Please enter a schedule name");return}if(l.value.upload_times.length===0){a.error("Please add at least one upload time");return}y.value=!0;try{x.value?(await v.put(`/api/schedules/${x.value.id}`,l.value),a.success("Schedule updated successfully!")):(await v.post("/api/schedules",l.value),a.success("Schedule created successfully!")),M(),k()}catch(o){if(console.error("Error saving schedule:",o),o.response?.data?.errors){const t=o.response.data.errors,s=Object.values(t)[0][0];a.error(s||"Failed to save schedule")}else o.response?.data?.message?a.error(o.response.data.message):a.error("Failed to save schedule. Please try again.")}finally{y.value=!1}},P=async o=>{if((await R.fire({title:"Are you sure?",text:"This will stop the automatic video generation for this schedule.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#ef4444",cancelButtonColor:"#64748b",confirmButtonText:"Yes, delete it!",background:T.value?"#0f172a":"#ffffff",color:T.value?"#f8fafc":"#0f172a"})).isConfirmed)try{await v.delete(`/api/schedules/${o.id}`),a.success("Schedule deleted"),k()}catch(s){console.error("Error deleting schedule:",s),s.response?.status===404?(a.error("Schedule not found. It may have been deleted already."),k()):s.response?.data?.message?a.error(s.response.data.message):a.error("Failed to delete schedule")}},D=async o=>{try{await v.patch(`/api/schedules/${o.id}`,{is_active:!o.is_active}),o.is_active=!o.is_active,a.success(o.is_active?"Schedule activated":"Schedule deactivated")}catch(t){console.error("Error toggling schedule:",t),a.error("Failed to update schedule")}},F=async o=>{try{await v.post(`/api/schedules/${o.id}/generate`),a.success("Video generation started!")}catch(t){console.error("Error generating video:",t),a.error("Failed to generate video")}};return Y(()=>{k(),z()}),(o,t)=>(r(),G(J,null,{header:S(()=>[...t[5]||(t[5]=[V(" Schedules ",-1)])]),actions:S(()=>[e("button",{onClick:C,class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg transition-all shadow-sm flex items-center gap-2 text-sm"},[...t[6]||(t[6]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})],-1),V(" New Schedule ",-1)])])]),default:S(()=>[K(O(q),{title:"Schedules"}),t[29]||(t[29]=e("div",{class:"mb-8"},[e("h1",{class:"text-3xl font-bold text-slate-900 dark:text-white mb-2"},"Auto-Upload Scheduler"),e("p",{class:"text-slate-600 dark:text-slate-400"},"Set up automatic video generation and upload schedules for your channels")],-1)),h.value.length===0?(r(),i("div",X,[t[7]||(t[7]=e("svg",{class:"w-16 h-16 mx-auto text-slate-300 dark:text-slate-600 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)),t[8]||(t[8]=e("h3",{class:"text-lg font-bold text-slate-700 dark:text-slate-300 mb-2"},"No schedules yet",-1)),t[9]||(t[9]=e("p",{class:"text-slate-500 dark:text-slate-400 mb-4"},"Create your first automated video schedule",-1)),e("button",{onClick:C,class:"px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white font-bold rounded-lg"},"Create Schedule")])):(r(),i("div",Z,[(r(!0),i(b,null,p(h.value,s=>(r(),i("div",{key:s.id,class:m(["bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-slate-200 dark:border-slate-800 overflow-hidden",{"opacity-75":!s.is_active}])},[e("div",ee,[e("div",te,[e("div",se,[e("h3",oe,d(s.name),1),e("p",le,d(s.style.replace("_"," ")),1)]),e("div",ae,[e("button",{onClick:n=>F(s),class:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-400",title:"Generate Now"},[...t[10]||(t[10]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1)])],8,re),e("button",{onClick:n=>D(s),class:m(["p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800",s.is_active?"text-green-600":"text-slate-400"]),title:"Toggle"},[...t[11]||(t[11]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})],-1)])],10,de),e("button",{onClick:n=>C(s),class:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-600 dark:text-slate-400",title:"Edit"},[...t[12]||(t[12]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ie),e("button",{onClick:n=>P(s),class:"p-2 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600",title:"Delete"},[...t[13]||(t[13]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)])],8,ne)])]),e("div",ue,[e("div",ce,[t[14]||(t[14]=e("span",{class:"text-slate-600 dark:text-slate-400"},"Videos per day",-1)),e("span",be,d(s.videos_per_day),1)]),e("div",pe,[t[15]||(t[15]=e("span",{class:"text-slate-600 dark:text-slate-400"},"Format",-1)),e("span",xe,d(s.aspect_ratio==="16:9"?"Landscape":"Shorts"),1)]),e("div",me,[t[16]||(t[16]=e("span",{class:"text-slate-600 dark:text-slate-400"},"Timezone",-1)),e("span",ve,d(s.timezone),1)]),e("div",ge,[t[17]||(t[17]=e("span",{class:"text-slate-600 dark:text-slate-400"},"Upload times",-1)),e("div",ke,[(r(!0),i(b,null,p(s.upload_times||[],n=>(r(),i("span",{key:n,class:"px-2 py-1 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded text-xs font-mono font-bold"},d(n),1))),128))])]),s.youtube_channel?(r(),i("div",fe,[e("img",{src:s.youtube_channel.channel_thumbnail,class:"w-6 h-6 rounded-full"},null,8,he),e("span",_e,d(s.youtube_channel.channel_title),1)])):A("",!0)])]),e("div",ye,[e("div",we,[e("span",{class:m(["text-xs font-semibold",s.is_active?"text-green-600":"text-slate-500"])},d(s.is_active?"● Active":"○ Paused"),3),e("span",Ce,d(Math.ceil(s.videos_per_day/(s.upload_times?.length||1)))+" videos × "+d(s.upload_times?.length||0)+" times ",1)])])],2))),128))])),w.value?(r(),i("div",{key:2,class:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:Q(M,["self"])},[e("div",Me,[e("div",Se,[e("h2",Ae,d(x.value?"Edit Schedule":"Create New Schedule"),1)]),e("div",Te,[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"Schedule Name",-1)),g(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>l.value.name=s),type:"text",class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-white",placeholder:"e.g., Daily Science Shorts"},null,512),[[f,l.value.name]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"Content Style",-1)),e("div",Ve,[(r(),i(b,null,p(j,s=>e("div",{key:s.id,onClick:n=>l.value.style=s.id,class:m(["cursor-pointer p-3 rounded-xl border-2 text-center",l.value.style===s.id?"border-indigo-600 bg-indigo-50 dark:bg-indigo-900/20":"border-slate-200 dark:border-slate-700 hover:border-slate-300"])},[e("div",$e,d(s.name),1)],10,Ee)),64))])]),e("div",je,[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"Format",-1)),e("div",ze,[(r(),i(b,null,p(["16:9","9:16"],s=>e("button",{key:s,onClick:n=>l.value.aspect_ratio=s,class:m(["flex-1 py-2 text-sm font-bold rounded-lg",l.value.aspect_ratio===s?"bg-white dark:bg-slate-700 text-indigo-600":"text-slate-500"])},d(s==="16:9"?"Landscape":"Shorts"),11,Ue)),64))])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"Videos per Day",-1)),g(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>l.value.videos_per_day=s),type:"number",min:"1",max:"50",class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-white"},null,512),[[f,l.value.videos_per_day,void 0,{number:!0}]])])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"Timezone",-1)),g(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>l.value.timezone=s),class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-white"},[(r(),i(b,null,p($,s=>e("option",{key:s,value:s},d(s),9,Be)),64))],512),[[W,l.value.timezone]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-3"},"Upload Times",-1)),e("div",He,[(r(!0),i(b,null,p(l.value.upload_times,(s,n)=>(r(),i("span",{key:n,class:"px-3 py-2 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded-lg flex items-center space-x-2"},[e("span",Ne,d(s),1),e("button",{onClick:tt=>N(n),class:"text-indigo-800 dark:text-indigo-300 hover:text-red-600 font-bold"},"×",8,Le)]))),128))]),e("div",Pe,[e("div",De,[t[23]||(t[23]=e("label",{class:"text-xs font-bold text-slate-600 dark:text-slate-400 uppercase mb-2 block"},"Quick Add Common Times",-1)),e("div",Fe,[(r(),i(b,null,p(H,s=>e("button",{key:s.time,onClick:n=>B(parseInt(s.time.split(":")[0])),disabled:l.value.upload_times.includes(s.time),class:m(["px-3 py-2 text-xs font-semibold rounded-lg transition-all border disabled:opacity-50 disabled:cursor-not-allowed",l.value.upload_times.includes(s.time)?"bg-indigo-100 dark:bg-indigo-900/30 border-indigo-300 dark:border-indigo-700 text-indigo-600 dark:text-indigo-400":"bg-white dark:bg-slate-700 border-slate-200 dark:border-slate-600 text-slate-700 dark:text-slate-300 hover:border-indigo-500 hover:text-indigo-600"])},d(s.time),11,Ie)),64))])]),e("div",Ye,[t[24]||(t[24]=e("label",{class:"text-xs font-bold text-slate-600 dark:text-slate-400 uppercase mb-2 block"},"Custom Time",-1)),e("div",Ge,[g(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>c.value=s),type:"time",class:"flex-1 px-3 py-2 bg-white dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-white text-sm"},null,512),[[f,c.value]]),e("button",{onClick:U,disabled:!c.value||l.value.upload_times.includes(c.value),class:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-bold rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed"}," Add ",8,Ke)])])])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"Upload Destination",-1)),e("div",Oe,[_.value.length>0?(r(),i("div",qe,[t[26]||(t[26]=e("label",{class:"text-xs text-slate-500 font-bold uppercase"},"YouTube Channel",-1)),e("div",Qe,[(r(!0),i(b,null,p(_.value,s=>(r(),i("div",{key:s.id,onClick:n=>l.value.youtube_token_id=s.id,class:m(["flex items-center p-3 border rounded-xl cursor-pointer",l.value.youtube_token_id===s.id?"border-red-500 bg-red-50 dark:bg-red-900/20":"bg-white dark:bg-slate-800 border-slate-200 dark:border-slate-700"])},[e("img",{src:s.channel_thumbnail,class:"w-8 h-8 rounded-full mr-3"},null,8,Je),e("span",Re,d(s.channel_title),1)],10,We))),128))])])):A("",!0)])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-semibold text-slate-700 dark:text-slate-300 mb-2"},"Prompt Template (Optional)",-1)),g(e("textarea",{"onUpdate:modelValue":t[4]||(t[4]=s=>l.value.prompt_template=s),rows:"2",class:"w-full px-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl focus:outline-none focus:ring-2 focus:ring-indigo-500 dark:text-white",placeholder:"Custom prompt for AI story generation..."},null,512),[[f,l.value.prompt_template]])])]),e("div",Xe,[e("button",{onClick:M,class:"px-6 py-2 rounded-xl font-bold text-slate-600 dark:text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors"},"Cancel"),e("button",{onClick:L,disabled:y.value,class:"px-6 py-2 rounded-xl font-bold text-white bg-indigo-600 hover:bg-indigo-700 transition-colors disabled:opacity-50"},d(x.value?"Update":"Create")+" Schedule ",9,Ze)])])])):A("",!0)]),_:1}))}};export{at as default};
